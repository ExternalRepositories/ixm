include_guard(GLOBAL)

set_property(GLOBAL PROPERTY ixm::color::alice_blue 240 248 255)
set_property(GLOBAL PROPERTY ixm::color::antique_white 250 253 215)
set_property(GLOBAL PROPERTY ixm::color::aqua 0 255 255)
set_property(GLOBAL PROPERTY ixm::color::aquamarine 127 255 212)
set_property(GLOBAL PROPERTY ixm::color::azure 240 255 255)
set_property(GLOBAL PROPERTY ixm::color::beige 245 245 220)
set_property(GLOBAL PROPERTY ixm::color::bisque 255 228 196)
set_property(GLOBAL PROPERTY ixm::color::black 0 0 0)
set_property(GLOBAL PROPERTY ixm::color::blanched_almond 255 235 205)
set_property(GLOBAL PROPERTY ixm::color::blue 0 0 255)
set_property(GLOBAL PROPERTY ixm::color::blue_violet 138 43 226)
set_property(GLOBAL PROPERTY ixm::color::brown 165 42 42)
set_property(GLOBAL PROPERTY ixm::color::burly_wood 222 184 135)
set_property(GLOBAL PROPERTY ixm::color::cadet_blue 95 158 160)
set_property(GLOBAL PROPERTY ixm::color::chartreuse 127 255 0)
set_property(GLOBAL PROPERTY ixm::color::chocolate 210 105 30)
set_property(GLOBAL PROPERTY ixm::color::coral 255 127 80)
set_property(GLOBAL PROPERTY ixm::color::cornflower_blue 100 149 237)
set_property(GLOBAL PROPERTY ixm::color::cornsilk 255 248 220)
set_property(GLOBAL PROPERTY ixm::color::crimson 220 20 60)
set_property(GLOBAL PROPERTY ixm::color::cyan 0 255 255)
set_property(GLOBAL PROPERTY ixm::color::dark_blue 0 0 139)
set_property(GLOBAL PROPERTY ixm::color::dark_cyan 0 139 139)
set_property(GLOBAL PROPERTY ixm::color::dark_golden_rod 184 134 11)
set_property(GLOBAL PROPERTY ixm::color::dark_gray 169 169 169)
set_property(GLOBAL PROPERTY ixm::color::dark_green 0 100 0)
set_property(GLOBAL PROPERTY ixm::color::dark_khaki 189 183 107)
set_property(GLOBAL PROPERTY ixm::color::dark_magenta 139 0 139)
set_property(GLOBAL PROPERTY ixm::color::dark_olive_green 85 107 47)
set_property(GLOBAL PROPERTY ixm::color::dark_orange 255 140 0)
set_property(GLOBAL PROPERTY ixm::color::dark_orchid 153 50 204)
set_property(GLOBAL PROPERTY ixm::color::dark_red 139 0 0)
set_property(GLOBAL PROPERTY ixm::color::dark_salmon 233 150 122)
set_property(GLOBAL PROPERTY ixm::color::dark_sea_green 143 188 143)
set_property(GLOBAL PROPERTY ixm::color::dark_slate_blue 72 61 139)
set_property(GLOBAL PROPERTY ixm::color::dark_slate_gray 47 79 79)
set_property(GLOBAL PROPERTY ixm::color::dark_turquoise 0 206 209)
set_property(GLOBAL PROPERTY ixm::color::dark_violet 148 0 211)
set_property(GLOBAL PROPERTY ixm::color::deep_pink 255 20 147)
set_property(GLOBAL PROPERTY ixm::color::deep_sky_blue 0 191 255)
set_property(GLOBAL PROPERTY ixm::color::dim_gray 105 105 105)
set_property(GLOBAL PROPERTY ixm::color::dodger_blue 30 144 255)
set_property(GLOBAL PROPERTY ixm::color::fire_brick 178 34 34)
set_property(GLOBAL PROPERTY ixm::color::floral_white 255 250 240)
set_property(GLOBAL PROPERTY ixm::color::forest_green 34 139 34)
set_property(GLOBAL PROPERTY ixm::color::fuchsia 255 0 255)
set_property(GLOBAL PROPERTY ixm::color::gainsboro 220 220 220)
set_property(GLOBAL PROPERTY ixm::color::ghost_white 248 248 255)
set_property(GLOBAL PROPERTY ixm::color::gold 255 215 0)
set_property(GLOBAL PROPERTY ixm::color::golden_rod 218 165 32)
set_property(GLOBAL PROPERTY ixm::color::gray 128 128 128)
set_property(GLOBAL PROPERTY ixm::color::green 0 128 0)
set_property(GLOBAL PROPERTY ixm::color::green_yellow 173 255 47)
set_property(GLOBAL PROPERTY ixm::color::honey_dew 240 255 240)
set_property(GLOBAL PROPERTY ixm::color::hot_pink 255 105 180)
set_property(GLOBAL PROPERTY ixm::color::indian_red 205 92 92)
set_property(GLOBAL PROPERTY ixm::color::indigo 75 0 130)
set_property(GLOBAL PROPERTY ixm::color::ivory 255 255 240)
set_property(GLOBAL PROPERTY ixm::color::khaki 240 230 140)
set_property(GLOBAL PROPERTY ixm::color::lavender 230 230 250)
set_property(GLOBAL PROPERTY ixm::color::lavender_blush 255 240 245)
set_property(GLOBAL PROPERTY ixm::color::lawn_green 124 252 0)
set_property(GLOBAL PROPERTY ixm::color::lemon_chiffon 255 250 205)
set_property(GLOBAL PROPERTY ixm::color::light_blue 173 216 230)
set_property(GLOBAL PROPERTY ixm::color::light_coral 240 128 128)
set_property(GLOBAL PROPERTY ixm::color::light_cyan 224 255 255)
set_property(GLOBAL PROPERTY ixm::color::light_golden_rod_yellow 250 250 210)
set_property(GLOBAL PROPERTY ixm::color::light_gray 211 211 211)
set_property(GLOBAL PROPERTY ixm::color::light_green 144 238 144)
set_property(GLOBAL PROPERTY ixm::color::light_pink 255 182 193)
set_property(GLOBAL PROPERTY ixm::color::light_salmon 255 160 122)
set_property(GLOBAL PROPERTY ixm::color::light_sea_green 32 178 170)
set_property(GLOBAL PROPERTY ixm::color::light_sky_blue 135 206 250)
set_property(GLOBAL PROPERTY ixm::color::light_slate_gray 119 136 153)
set_property(GLOBAL PROPERTY ixm::color::light_steel_blue 176 196 222)
set_property(GLOBAL PROPERTY ixm::color::light_yellow 255 255 224)
set_property(GLOBAL PROPERTY ixm::color::lime 0 255 0)
set_property(GLOBAL PROPERTY ixm::color::lime_green 50 205 50)
set_property(GLOBAL PROPERTY ixm::color::linen 250 240 230)
set_property(GLOBAL PROPERTY ixm::color::magenta 255 0 255)
set_property(GLOBAL PROPERTY ixm::color::maroon 128 0 0)
set_property(GLOBAL PROPERTY ixm::color::medium_aquamarine 102 205 170)
set_property(GLOBAL PROPERTY ixm::color::medium_blue 0 0 205)
set_property(GLOBAL PROPERTY ixm::color::medium_orchid 186 85 211)
set_property(GLOBAL PROPERTY ixm::color::medium_purple 147 112 219)
set_property(GLOBAL PROPERTY ixm::color::medium_sea_green 60 179 113)
set_property(GLOBAL PROPERTY ixm::color::medium_slate_blue 123 104 238)
set_property(GLOBAL PROPERTY ixm::color::medium_spring_green 0 250 154)
set_property(GLOBAL PROPERTY ixm::color::medium_turquoise 72 209 204)
set_property(GLOBAL PROPERTY ixm::color::medium_violet_red 199 21 133)
set_property(GLOBAL PROPERTY ixm::color::midnight_blue 25 25 112)
set_property(GLOBAL PROPERTY ixm::color::mint_cream 245 255 250)
set_property(GLOBAL PROPERTY ixm::color::misty_rose 255 228 225)
set_property(GLOBAL PROPERTY ixm::color::moccasin 255 228 181)
set_property(GLOBAL PROPERTY ixm::color::navajo_white 255 222 173)
set_property(GLOBAL PROPERTY ixm::color::navy 0 0 128)
set_property(GLOBAL PROPERTY ixm::color::old_lace 253 245 230)
set_property(GLOBAL PROPERTY ixm::color::olive 128 128 0)
set_property(GLOBAL PROPERTY ixm::color::olive_drab 107 142 35)
set_property(GLOBAL PROPERTY ixm::color::orange 255 165 0)
set_property(GLOBAL PROPERTY ixm::color::orange_red 255 69 0)
set_property(GLOBAL PROPERTY ixm::color::orchid 218 112 214)
set_property(GLOBAL PROPERTY ixm::color::pale_golden_rod 238 232 170)
set_property(GLOBAL PROPERTY ixm::color::pale_green 152 251 152)
set_property(GLOBAL PROPERTY ixm::color::pale_turquoise 175 238 238)
set_property(GLOBAL PROPERTY ixm::color::pale_violet_red 219 112 147)
set_property(GLOBAL PROPERTY ixm::color::papaya_whip 255 239 213)
set_property(GLOBAL PROPERTY ixm::color::peach_puff 255 218 185)
set_property(GLOBAL PROPERTY ixm::color::peru 205 133 63)
set_property(GLOBAL PROPERTY ixm::color::pink 255 192 203)
set_property(GLOBAL PROPERTY ixm::color::plum 221 160 221)
set_property(GLOBAL PROPERTY ixm::color::powder_blue 176 224 230)
set_property(GLOBAL PROPERTY ixm::color::purple 128 0 128)
set_property(GLOBAL PROPERTY ixm::color::rebecca_purple 102 51 153)
set_property(GLOBAL PROPERTY ixm::color::red 255 0 0)
set_property(GLOBAL PROPERTY ixm::color::rosy_brown 188 143 143)
set_property(GLOBAL PROPERTY ixm::color::royal_blue 65 105 225)
set_property(GLOBAL PROPERTY ixm::color::saddle_brown 139 69 19)
set_property(GLOBAL PROPERTY ixm::color::salmon 250 128 114)
set_property(GLOBAL PROPERTY ixm::color::sandy_brown 244 164 96)
set_property(GLOBAL PROPERTY ixm::color::sea_green 46 139 87)
set_property(GLOBAL PROPERTY ixm::color::sea_shell 255 245 238)
set_property(GLOBAL PROPERTY ixm::color::sienna 160 82 45)
set_property(GLOBAL PROPERTY ixm::color::silver 192 192 192)
set_property(GLOBAL PROPERTY ixm::color::sky_blue 135 206 235)
set_property(GLOBAL PROPERTY ixm::color::slate_blue 106 90 205)
set_property(GLOBAL PROPERTY ixm::color::slate_gray 112 128 144)
set_property(GLOBAL PROPERTY ixm::color::snow 255 250 250)
set_property(GLOBAL PROPERTY ixm::color::spring_green 0 255 127)
set_property(GLOBAL PROPERTY ixm::color::steel_blue 70 130 180)
set_property(GLOBAL PROPERTY ixm::color::tan 210 180 140)
set_property(GLOBAL PROPERTY ixm::color::teal 0 128 128)
set_property(GLOBAL PROPERTY ixm::color::thistle 216 191 216)
set_property(GLOBAL PROPERTY ixm::color::tomato 255 99 71)
set_property(GLOBAL PROPERTY ixm::color::turquoise 64 224 208)
set_property(GLOBAL PROPERTY ixm::color::violet 238 130 238)
set_property(GLOBAL PROPERTY ixm::color::wheat 245 222 179)
set_property(GLOBAL PROPERTY ixm::color::white 255 255 255)
set_property(GLOBAL PROPERTY ixm::color::white_smoke 245 245 245)
set_property(GLOBAL PROPERTY ixm::color::yellow 255 255 0)
set_property(GLOBAL PROPERTY ixm::color::yellow_green 154 205 50)

function (colorize out-var)
  if (WIN32 AND NOT CMAKE_GENERATOR STREQUAL "Ninja")
    return()
  endif()
  string(ASCII 27 esc)
  set(regexp "<[^>]+>[^<]*</[^>]*>")
  list(JOIN ARGN " " text)
  string(REGEX MATCHALL ${regexp} matched ${text})
  while (matched)
    foreach (match IN LISTS matched)
      string(REGEX MATCH "<([^>]+)>([^<]+)</([^>]*)>" match "${match}")
      get_property(color GLOBAL PROPERTY ixm::color::${CMAKE_MATCH_1})
      if (color)
        set(foreground "${esc}[38;2;${color}m")
        set(reset "${esc}[m")
      endif()
      set(replacement "${foreground}${CMAKE_MATCH_2}${reset}")
      string(REPLACE "${match}" "${replacement}" text "${text}")
    endforeach()
    string(REGEX MATCHALL ${regexp} matched ${text})
  endwhile()
  set(${out-var} ${text} PARENT_SCOPE)
endfunction()

# Defines COLOR variables in PARENT_SCOPE
# We actually only define BOLD so the colors stand out :v
function(colors)
  # TODO: Initial configuration 
  if (WIN32 AND NOT CMAKE_GENERATOR STREQUAL "Ninja")
    return()
  endif()
  set(PREFIX COLOR_)
  string(ASCII 27 esc)
  set(${PREFIX}RESET "${esc}[m" PARENT_SCOPE)
  set(${PREFIX}BOLD "${esc}[1m" PARENT_SCOPE)
  set(${PREFIX}RED "${esc}[1;31m" PARENT_SCOPE)
  set(${PREFIX}GREEN "${esc}[1;32m" PARENT_SCOPE)
  set(${PREFIX}YELLOW "${esc}[1;33m" PARENT_SCOPE)
  set(${PREFIX}BLUE "${esc}[1;34m" PARENT_SCOPE)
  set(${PREFIX}MAGENTA "${esc}[1;35m" PARENT_SCOPE)
  set(${PREFIX}CYAN "${esc}[1;36m" PARENT_SCOPE)
endfunction()

#[[ For my friends across the pond :) ]]
macro(colours)
  colors(${ARGN})
endmacro()
