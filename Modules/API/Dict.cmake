include_guard(GLOBAL)

import(IXM::Common::Dict)

function (dict @dict:action name)
  if (@dict:action STREQUAL "LOAD")
    ixm_dict_load(${name} ${ARGN})
  elseif (@dict:action STREQUAL "SAVE")
    ixm_dict_save(${name} ${ARGN})
  elseif (@dict:action STREQUAL "JSON")
    ixm_dict_json(${name} ${ARGN})
  elseif (@dict:action STREQUAL "TRANSFORM")
    log(FATAL "dict(TRANSFORM) is not yet implemented")
  elseif (@dict:action STREQUAL "INSERT")
    ixm_dict_insert(${name} ${ARGN})
  elseif (@dict:action STREQUAL "SET")
    ixm_dict_set(${name} ${ARGN})
  elseif (@dict:action STREQUAL "REMOVE")
    ixm_dict_remove(${name} ${ARGN})
  elseif (@dict:action STREQUAL "CLEAR")
    ixm_dict_clear(${name} ${ARGN})
  elseif (@dict:action STREQUAL "MERGE")
    ixm_dict_merge(${name} ${ARGN})
  elseif (@dict:action STREQUAL "KEYS")
    ixm_dict_keys(${name} ${ARGN})
  elseif (@dict:action STREQUAL "GET")
    ixm_dict_get(${name} ${ARGN})
  else()
    log(FATAL "dict(${\@dict\:action}) is an invalid operation")
  endif()
  set(returns KEYS GET)
  if (@dict:action IN_LIST returns)
    list(GET ARGN -1 @dict:returns)
    set(${\@dict\:returns} ${${\@dict\:returns}} PARENT_SCOPE)
  endif()
endfunction()